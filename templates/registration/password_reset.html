{% extends 'base.html' %}

{% block title %}Reset Password - GhostPin{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-md w-full space-y-8">
        <!-- Header -->
        <div class="text-center">
            <div class="mx-auto h-16 w-16 bg-gradient-to-br from-red-400 to-pink-500 rounded-full flex items-center justify-center mb-6">
                <i class="fas fa-key text-2xl text-white"></i>
            </div>
            <h2 class="text-3xl font-bold text-gray-900 mb-2">Reset Your Password</h2>
            <p class="text-gray-600">Enter your email address and we'll send you a link to reset your password</p>
        </div>

        <!-- Password Reset Form -->
        <div class="bg-white rounded-lg shadow-xl p-8">
            {% if form.errors %}
                <div class="mb-6 bg-red-50 border border-red-200 rounded-md p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-circle text-red-400"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-red-800">
                                There was an error with your request
                            </h3>
                            <div class="mt-2 text-sm text-red-700">
                                {% for field, errors in form.errors.items %}
                                    {% for error in errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}

            <form method="post" class="space-y-6">
                {% csrf_token %}
                
                <!-- Email Field -->
                <div>
                    <label for="{{ form.email.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-envelope text-blue-600 mr-1"></i>
                        Email Address
                    </label>
                    {{ form.email }}
                    {% if form.email.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.email.errors.0 }}</p>
                    {% endif %}
                    <p class="mt-2 text-sm text-gray-500">
                        Enter the email address associated with your GhostPin account
                    </p>
                </div>

                <!-- Submit Button -->
                <button type="submit" 
                        class="w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold py-3 px-4 rounded-md transition-all duration-200 transform hover:scale-105">
                    <i class="fas fa-paper-plane mr-2"></i>
                    Send Reset Link
                </button>
            </form>

            <!-- Additional Information -->
            <div class="mt-6 bg-blue-50 rounded-lg p-4">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <i class="fas fa-info-circle text-blue-400"></i>
                    </div>
                    <div class="ml-3">
                        <h3 class="text-sm font-medium text-blue-800">What happens next?</h3>
                        <div class="mt-2 text-sm text-blue-700">
                            <ul class="list-disc list-inside space-y-1">
                                <li>We'll send a password reset link to your email</li>
                                <li>Click the link to create a new password</li>
                                <li>The link will expire in 24 hours for security</li>
                                <li>Check your spam folder if you don't see the email</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Back to Login -->
            <div class="mt-6 text-center">
                <p class="text-sm text-gray-600">
                    Remember your password? 
                    <a href="{% url 'login' %}" class="font-medium text-blue-600 hover:text-blue-800 transition-colors">
                        <i class="fas fa-arrow-left mr-1"></i>
                        Back to Sign In
                    </a>
                </p>
            </div>
        </div>

        <!-- Help Section -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-4 text-center">
                <i class="fas fa-question-circle text-yellow-500 mr-2"></i>
                Need Help?
            </h3>
            
            <div class="space-y-4">
                <div class="flex items-start space-x-3">
                    <div class="w-6 h-6 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                        <i class="fas fa-check text-green-600 text-xs"></i>
                    </div>
                    <div>
                        <div class="font-medium text-gray-900">Can't find the reset email?</div>
                        <div class="text-sm text-gray-600">Check your spam/junk folder and add noreply@ghostpin.com to your contacts</div>
                    </div>
                </div>
                
                <div class="flex items-start space-x-3">
                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                        <i class="fas fa-clock text-blue-600 text-xs"></i>
                    </div>
                    <div>
                        <div class="font-medium text-gray-900">Link expired?</div>
                        <div class="text-sm text-gray-600">Password reset links expire after 24 hours. Request a new one if needed</div>
                    </div>
                </div>
                
                <div class="flex items-start space-x-3">
                    <div class="w-6 h-6 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                        <i class="fas fa-envelope text-purple-600 text-xs"></i>
                    </div>
                    <div>
                        <div class="font-medium text-gray-900">Wrong email address?</div>
                        <div class="text-sm text-gray-600">Make sure you're using the email address you registered with</div>
                    </div>
                </div>
                
                <div class="flex items-start space-x-3">
                    <div class="w-6 h-6 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                        <i class="fas fa-life-ring text-red-600 text-xs"></i>
                    </div>
                    <div>
                        <div class="font-medium text-gray-900">Still having trouble?</div>
                        <div class="text-sm text-gray-600">
                            Contact our support team at 
                            <a href="mailto:support@ghostpin.com" class="text-blue-600 hover:text-blue-800">support@ghostpin.com</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Security Notice -->
        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
            <div class="flex">
                <div class="flex-shrink-0">
                    <i class="fas fa-shield-alt text-yellow-400"></i>
                </div>
                <div class="ml-3">
                    <h3 class="text-sm font-medium text-yellow-800">Security Notice</h3>
                    <div class="mt-2 text-sm text-yellow-700">
                        <p>
                            For your security, password reset links can only be used once and expire after 24 hours. 
                            If you didn't request this reset, you can safely ignore this email.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Form validation
    document.querySelector('form').addEventListener('submit', function(e) {
        const email = document.querySelector('input[name="email"]').value.trim();
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        
        if (!email) {
            e.preventDefault();
            alert('Please enter your email address.');
            return false;
        }
        
        if (!emailRegex.test(email)) {
            e.preventDefault();
            alert('Please enter a valid email address.');
            return false;
        }
        
        // Show loading state
        const submitBtn = document.querySelector('button[type="submit"]');
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Sending...';
        submitBtn.disabled = true;
        
        // Re-enable button after 5 seconds (in case of error)
        setTimeout(() => {
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        }, 5000);
    });
    
    // Auto-focus email field
    document.addEventListener('DOMContentLoaded', function() {
        const emailField = document.querySelector('input[name="email"]');
        if (emailField) {
            emailField.focus();
        }
    });
    
    // Email validation on input
    document.querySelector('input[name="email"]').addEventListener('input', function(e) {
        const email = e.target.value.trim();
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        
        if (email && !emailRegex.test(email)) {
            e.target.classList.add('border-red-300');
            e.target.classList.remove('border-gray-300');
        } else {
            e.target.classList.remove('border-red-300');
            e.target.classList.add('border-gray-300');
        }
    });
</script>
{% endblock %}

